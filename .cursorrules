# Cursor Rules for EORI Platform

## Database Migrations

**IMPORTANT**: Database migrations are managed through SQL scripts that must be run manually by the user.

- Migrations are located in `database/migrations/`
- Migration files follow the pattern: `000X_description.sql`
- **DO NOT** use `drizzle-kit push` or `drizzle-kit migrate` to apply migrations automatically
- **DO** use `drizzle-kit generate` to generate migration files from schema changes
- **DO** run SQL migration scripts manually using your preferred PostgreSQL client (psql, pgAdmin, etc.)
- Always test migrations on a development database before applying to production
- **DO NOT** run seed scripts - migrations are done manually through SQL scripts

## Schema Changes Workflow

1. Modify schema files in `database/schema/`
2. Run `npm run db:generate` to generate migration SQL
3. Review the generated migration file
4. Run the migration SQL script manually against the database
5. Verify the changes were applied correctly

## Code Style

- Use TypeScript for all code
- Follow existing patterns for API routes, hooks, and components
- Use snake_case for database column names
- Use camelCase for TypeScript variables and functions
- Use PascalCase for component names

## Page Titles

- When creating new pages, the page title must follow the format: `"{Page Name} - EORI"`
- Example: "Dashboard - EORI", "Users Management - EORI", "Settings - EORI"
- Ensure the title is set in the page component using the appropriate method (e.g., `useEffect` with `document.title` or metadata configuration)

## New Entity Verification Checklist

**IMPORTANT**: When adding any new entity or plan, you MUST verify the following:

1. **Sidebar Menu Inclusion**
   - Ensure the new entity is added to the sidebar menu
   - Verify the menu item is properly configured with correct routes and icons
   - Check that the menu item appears for users with appropriate permissions

2. **Permission Verification (Not Just Authentication)**
   - Verify permissions are checked, not just authentication status
   - Ensure all API routes and pages check for specific permissions
   - Do not rely solely on authentication - always verify the user has the required permissions

3. **Permission Definitions**
   - Add permission definitions for the new entity in the permissions system
   - Ensure permissions are properly registered and can be assigned to roles
   - Verify permissions are checked at both API and UI levels




